function renderItineranciasHandler(a){$.event.trigger({type:"verItinerancia",exposicion_marker:a.target})}Handlebars.registerHelper("equal",function(a,b,c){if(arguments.length<3)throw new Error("Handlebars Helper equal needs 2 parameters");return a!=b?c.inverse(this):c.fn(this)}),this.ItineranciasTpls=this.ItineranciasTpls||{},Handlebars.registerPartial("slider-item",Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+=" slider-item--",(e=c.produccion)?d=e.call(a,{hash:{},data:b}):(e=a&&a.produccion,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i="",j="function",k=this.escapeExpression,l=this;return i+='<div class="mix y',(h=c.anio)?g=h.call(b,{hash:{},data:e}):(h=b&&b.anio,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+" thumbnail slider-item slider-item--",(h=c.tipo)?g=h.call(b,{hash:{},data:e}):(h=b&&b.tipo,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g),g=c["if"].call(b,b&&b.produccion,{hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e}),(g||0===g)&&(i+=g),i+='" data-layer="',(h=c.nid)?g=h.call(b,{hash:{},data:e}):(h=b&&b.nid,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+'" data-myorder="'+k((g=null==e||e===!1?e:e.index,typeof g===j?g.apply(b):g))+'">\n  <a class="imagen" href="#">\n  	<div class="gradient-image">\n  		<span class="gradient"></span>\n    	<img src="',(h=c.imagen)?g=h.call(b,{hash:{},data:e}):(h=b&&b.imagen,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+'" />\n    </div>\n    <div class="caption">\n      <div class="titulo">',(h=c.titulo)?g=h.call(b,{hash:{},data:e}):(h=b&&b.titulo,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+'</div>\n      <div class="fechas">',(h=c.fechas)?g=h.call(b,{hash:{},data:e}):(h=b&&b.fechas,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+'</div>\n    </div>\n    <span class="overlay"></span>\n  </a>\n</div>\n'})),this.ItineranciasTpls["app/templates/exposicion-globo.hbs"]=Handlebars.template(function(a,b,c,d,e){function f(){return'<img src="imgs/pin-actividad.png">'}function g(){return'<img src="imgs/pin-exposicion.png">'}function h(){return'<img src="imgs/pin-coleccion.png">'}function i(){return'<span class="tipo__texto">Actividad</span>'}function j(){return'<span class="tipo__texto">Exposición</span>'}function k(){return'<span class="tipo__texto">Colección</span>'}function l(){return'<div class="produccion">Producción propia</div>'}function m(){return'<div class="produccion">Producción ajena</div>'}function n(a){var b,c="";return c+='\n    <span class="label">Comisariado:</span> '+z((b=a&&a.exposicion,b=null==b||b===!1?b:b.comisario,typeof b===y?b.apply(a):b))+" <br>\n  "}function o(){return"+ detalles de la actividad"}function p(){return"+ detalles de la exposición"}function q(a,b,d){var e,f,g,h="";return h+='\n	  <div class="itinerancia',f=c.equal||a&&a.equal,g={hash:{},inverse:A.noop,fn:A.program(24,r,b),data:b},e=f?f.call(a,a&&a.nid,(e=d&&d.itinerancia,null==e||e===!1?e:e.nid),g):B.call(a,"equal",a&&a.nid,(e=d&&d.itinerancia,null==e||e===!1?e:e.nid),g),(e||0===e)&&(h+=e),h+='">\n	  	<div class="itinerancia-nombre">\n        ',e=c["if"].call(a,(e=a&&a.url,null==e||e===!1?e:e.length),{hash:{},inverse:A.program(28,t,b),fn:A.program(26,s,b),data:b}),(e||0===e)&&(h+=e),h+='\n	    </div>\n	    <div class="itinerancia-lugar">',(f=c.fechas)?e=f.call(a,{hash:{},data:b}):(f=a&&a.fechas,e=typeof f===y?f.call(a,{hash:{},data:b}):f),h+=z(e)+"</div>\n	  </div>\n	"}function r(){return" active"}function s(a,b){var d,e,f="";return f+='\n          <a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===y?e.call(a,{hash:{},data:b}):e),f+=z(d)+'" target="_blank">',(e=c.lugar)?d=e.call(a,{hash:{},data:b}):(e=a&&a.lugar,d=typeof e===y?e.call(a,{hash:{},data:b}):e),f+=z(d)+"</a>\n        "}function t(a,b){var d,e,f="";return f+="\n          ",(e=c.lugar)?d=e.call(a,{hash:{},data:b}):(e=a&&a.lugar,d=typeof e===y?e.call(a,{hash:{},data:b}):e),f+=z(d)+"\n        "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var u,v,w,x="",y="function",z=this.escapeExpression,A=this,B=c.helperMissing;return x+='<div class="tipo tipo--'+z((u=b&&b.exposicion,u=null==u||u===!1?u:u.tipo,typeof u===y?u.apply(b):u))+'">\n  ',v=c.equal||b&&b.equal,w={hash:{},inverse:A.noop,fn:A.program(1,f,e),data:e},u=v?v.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"actividad",w):B.call(b,"equal",(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"actividad",w),(u||0===u)&&(x+=u),x+="\n  ",v=c.equal||b&&b.equal,w={hash:{},inverse:A.noop,fn:A.program(3,g,e),data:e},u=v?v.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"exposicion",w):B.call(b,"equal",(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"exposicion",w),(u||0===u)&&(x+=u),x+="\n  ",v=c.equal||b&&b.equal,w={hash:{},inverse:A.noop,fn:A.program(5,h,e),data:e},u=v?v.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"coleccion_viaja",w):B.call(b,"equal",(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"coleccion_viaja",w),(u||0===u)&&(x+=u),x+="\n\n  ",v=c.equal||b&&b.equal,w={hash:{},inverse:A.noop,fn:A.program(7,i,e),data:e},u=v?v.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"actividad",w):B.call(b,"equal",(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"actividad",w),(u||0===u)&&(x+=u),x+="\n  ",v=c.equal||b&&b.equal,w={hash:{},inverse:A.noop,fn:A.program(9,j,e),data:e},u=v?v.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"exposicion",w):B.call(b,"equal",(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"exposicion",w),(u||0===u)&&(x+=u),x+="\n  ",v=c.equal||b&&b.equal,w={hash:{},inverse:A.noop,fn:A.program(11,k,e),data:e},u=v?v.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"coleccion_viaja",w):B.call(b,"equal",(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"coleccion_viaja",w),(u||0===u)&&(x+=u),x+="\n</div>\n",v=c.equal||b&&b.equal,w={hash:{},inverse:A.noop,fn:A.program(13,l,e),data:e},u=v?v.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.produccion),"propia",w):B.call(b,"equal",(u=b&&b.exposicion,null==u||u===!1?u:u.produccion),"propia",w),(u||0===u)&&(x+=u),x+="\n",v=c.equal||b&&b.equal,w={hash:{},inverse:A.noop,fn:A.program(15,m,e),data:e},u=v?v.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.produccion),"ajena",w):B.call(b,"equal",(u=b&&b.exposicion,null==u||u===!1?u:u.produccion),"ajena",w),(u||0===u)&&(x+=u),x+="\n\n<h2>"+z((u=b&&b.exposicion,u=null==u||u===!1?u:u.titulo,typeof u===y?u.apply(b):u))+'</h2>\n\n<div class="fecha-lugar">\n  '+z((u=b&&b.exposicion,u=null==u||u===!1?u:u.fechas,typeof u===y?u.apply(b):u))+" <br>\n  "+z((u=b&&b.exposicion,u=null==u||u===!1?u:u.lugar,typeof u===y?u.apply(b):u))+'\n</div>\n\n<img src="'+z((u=b&&b.exposicion,u=null==u||u===!1?u:u.imagen,typeof u===y?u.apply(b):u))+'" class="img-responsive">\n\n<div class="datos-exposicion">\n  <span class="label">Organización:</span>  '+z((u=b&&b.exposicion,u=null==u||u===!1?u:u.organizacion,typeof u===y?u.apply(b):u))+" <br>\n  ",u=c["if"].call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.comisario),{hash:{},inverse:A.noop,fn:A.program(17,n,e),data:e}),(u||0===u)&&(x+=u),x+='\n  <a href="http://www.museoreinasofia.es'+z((u=b&&b.exposicion,u=null==u||u===!1?u:u.url,typeof u===y?u.apply(b):u))+'" target="_blank" class="btn btn-default btn-block">\n    ',v=c.equal||b&&b.equal,w={hash:{},inverse:A.noop,fn:A.program(19,o,e),data:e},u=v?v.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"actividad",w):B.call(b,"equal",(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"actividad",w),(u||0===u)&&(x+=u),x+="\n    ",v=c.equal||b&&b.equal,w={hash:{},inverse:A.noop,fn:A.program(21,p,e),data:e},u=v?v.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"exposicion",w):B.call(b,"equal",(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"exposicion",w),(u||0===u)&&(x+=u),x+="\n    ",v=c.equal||b&&b.equal,w={hash:{},inverse:A.noop,fn:A.program(21,p,e),data:e},u=v?v.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"coleccion_viaja",w):B.call(b,"equal",(u=b&&b.exposicion,null==u||u===!1?u:u.tipo),"coleccion_viaja",w),(u||0===u)&&(x+=u),x+='\n  </a>\n</div>\n\n<h3>Itinerancias</h3>\n<div class="itinerancias">\n	',u=c.each.call(b,(u=b&&b.exposicion,null==u||u===!1?u:u.itinerancia),{hash:{},inverse:A.noop,fn:A.programWithDepth(23,q,e,b),data:e}),(u||0===u)&&(x+=u),x+="\n</div>\n"}),this.ItineranciasTpls["app/templates/slider.hbs"]=Handlebars.template(function(a,b,c,d,e){function f(a,b){var e,f="";return f+="\n          ",e=i.invokePartial(d["slider-item"],"slider-item",a,c,d,b),(e||0===e)&&(f+=e),f+="\n      "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),d=this.merge(d,a.partials),e=e||{};var g,h="",i=this;return h+='<div class="controls">\n  <label>Filtrar:</label>\n  <button class="filter active" data-filter="all" id="Reset">Todas</button>\n  <form id="Filters">\n    <fieldset>\n      <button class="filter filter--coleccion_viaja" data-filter=".slider-item--coleccion_viaja">Colección</button>\n      <button class="filter filter--exposicion" data-filter=".slider-item--exposicion">Exposición</button>\n      <button class="filter filter--exposicion filter--exposicion-tipo" data-filter=".slider-item--propia">Producción propia</button>\n      <button class="filter filter--exposicion filter--exposicion-tipo" data-filter=".slider-item--ajena">Producción ajena</button>\n      <button class="filter filter--actividad" data-filter=".slider-item--actividad">Actividad</button>\n    </fieldset>\n    <fieldset>\n      <button class="filter" data-filter=".y2015">2015</button>\n      <button class="filter" data-filter=".y2014">2014</button>\n      <button class="filter" data-filter=".y2013">2013</button>\n      <button class="filter" data-filter=".y2012">2012</button>\n      <button class="filter" data-filter=".y2011">2011</button>\n      <button class="filter" data-filter=".y2010">2010</button>\n      <button class="filter" data-filter=".y2009">2009</button>\n      <button class="filter" data-filter=".y2008">2008</button>\n      <button class="filter" data-filter=".y2007">2007</button>\n      <button class="filter" data-filter=".y2006">2006</button>\n      <button class="filter" data-filter=".y2005">2005</button>\n      <button class="filter" data-filter=".y2004">2004</button>\n      <button class="filter" data-filter=".y2003">2003</button>\n      <button class="filter" data-filter=".y2002">2002</button>\n      <button class="filter" data-filter=".y2001">2001</button>\n      <button class="filter" data-filter=".y2000">2000</button>\n      <button class="filter" data-filter=".y1999">1999</button>\n      <button class="filter" data-filter=".y1998">1998</button>\n      <button class="filter" data-filter=".y1997">1997</button>\n      <button class="filter" data-filter=".y1996">1996</button>\n      <button class="filter" data-filter=".y1995">1995</button>\n      <button class="filter" data-filter=".y1994">1994</button>\n      <button class="filter" data-filter=".y1993">1993</button>\n      <button class="filter" data-filter=".y1992">1992</button>\n      <button class="filter" data-filter=".y1991">1991</button>\n    </fieldset>\n  </form>\n</div>\n<div id="slider-container" class="slider-container thumbnails">\n      ',g=c.each.call(b,b,{hash:{},inverse:i.noop,fn:i.program(1,f,e),data:e}),(g||0===g)&&(h+=g),h+='\n      <div class="vacio"><p style="display:none"> No hay resultados para ese filtrado. Modifique su selección.</p></div>\n</div>\n\n'}),L.ItineranciaMarker=L.Marker.extend({initialize:function(a,b,c,d,e){this._exposicion=a,this._itinerancia=b,this._exposicionLayer=c,L.Marker.prototype.initialize.call(this,d,e)},getPopup:function(){var a=ItineranciasTpls["app/templates/exposicion-globo.hbs"];return a({exposicion:this._exposicion,itinerancia:this._itinerancia})},renderItinerancia:function(a){this._exposicionLayer.renderItinerancias(a)}}),L.itineranciaMarker=function(a,b,c,d,e){return new L.ItineranciaMarker(a,b,c,d,e)},L.ExposicionLayer=L.FeatureGroup.extend({options:{initLatLng:[]},initialize:function(a,b){this._exposicion=a,this._initLatLng=b.initLatLng,this._markerMuseo=b.markerMuseo,this._itineranciasLayer=L.featureGroup(),this._markers=[],this._colorResaltado=this.getColorResaltado(),this._colorExpo=this.getColorIconos();var c="itinerancia-marker y"+a.anio+"-marker slider-item--"+this._exposicion.tipo+"-marker slider-item--"+this._exposicion.tipo+"y"+a.anio+"-marker";""!==a.produccion&&(c=c+" slider-item--"+a.produccion+"-marker"),this._icon=L.MakiMarkers.icon({icon:"town-hall",color:this._colorExpo,size:"s",className:c,popupAnchor:[0,-130]}),this._iconResaltado=L.MakiMarkers.icon({icon:"town-hall",color:this._colorResaltado,size:"m",className:"itinerancia-resaltada-marker"}),L.FeatureGroup.prototype.initialize.call(this)},getColorIconos:function(){return"actividad"==this._exposicion.tipo?"#88d2e5":"coleccion_viaja"==this._exposicion.tipo?"#d24e5b":"#e7d800"},getColorResaltado:function(){return"#333"},onAdd:function(a){L.FeatureGroup.prototype.onAdd.call(this,a),this.addLayer(this._markerMuseo),this.addLayer(this._itineranciasLayer);for(var b=0;b<this._exposicion.itinerancia.length;++b)if(null!==this._exposicion.itinerancia[b].lat&&null!==this._exposicion.itinerancia[b].lng){itinerancia=this._exposicion.itinerancia[b];var c=L.itineranciaMarker(this._exposicion,itinerancia,this,[itinerancia.lat,itinerancia.lng],{icon:this._icon});c.bindPopup(null!=this._exposicion.itinerancia[b].url?"<a href='"+this._exposicion.itinerancia[b].url+"' target='_blank'>"+this._exposicion.itinerancia[b].lugar+"</a>":this._exposicion.itinerancia[b].lugar),this._markers.push(c),c.on("click",renderItineranciasHandler),this.addLayer(c)}else console.log("--> Itinerancia esta mal: "),console.log(this._exposicion)},renderItinerancias:function(a){this._itineranciasLayer.clearLayers();for(var b=0;b<this._exposicion.itinerancia.length;++b)itinerancia=this._exposicion.itinerancia[b],null!==this._exposicion.itinerancia[b].lat&&null!==this._exposicion.itinerancia[b].lng&&this._itineranciasLayer.addLayer(L.polyline([this._initLatLng,L.latLng(itinerancia.lat,itinerancia.lng)],{color:this._colorExpo,weight:5,className:"linea-itinerancia"}));this.resaltarIconos(),a||this._map.fitBounds(this.getBounds(),{animate:!0,duration:1,maxZoom:6,paddingTopLeft:[20,50],paddingBottomRight:[20,240]}),this.bringToFront()},resaltarIconos:function(){for(var a=0;a<this._markers.length;++a)this._markers[a].setIcon(this._iconResaltado)},clearItineranciasLayer:function(){this.clearResaltarIconos(),this._itineranciasLayer.clearLayers()},clearResaltarIconos:function(){for(var a=0;a<this._markers.length;++a)this._markers[a].setIcon(this._icon)}}),L.createExposicionLayer=function(a,b){return new L.ExposicionLayer(a,b)},L.ItineranciasMap=L.Map.extend({initialize:function(a,b,c){this._exposiciones=b,this._initZoom=c.initZoom,this._initLatLng=c.initLatLng,this._exposicionesLayersHashMap={},this._exposicionesLayers=L.layerGroup(),this._mapCenter=c.mapCenter,this._renderMarkerMuseo(),this._initializeExposicionesLayers(this._exposicionesLayers,this._exposicionesLayersHashMap),c.layers=new Array(this._exposicionesLayers),L.Map.prototype.initialize.call(this,a,c)},_renderMarkerMuseo:function(){var a=L.MakiMarkers.icon({icon:"town-hall",color:"#333",size:"s",className:"mncars-marker"});this._markerMuseo=L.marker(this._initLatLng,{icon:a}),this._markerMuseo.bindPopup("<img src='imgs/logo.negro.png' id='logo-popup'><a href='http://www.museoreinasofia.es' target='_blank'><strong>Museo Nacional Centro de Arte Reina Sofía</strong></a><br> Madrid"),this._markerMuseo.setZIndexOffset(1e6)},_initializeExposicionesLayers:function(a,b){var c=this;$.each(this._exposiciones,function(d,e){var f=L.createExposicionLayer(e,{initLatLng:c._initLatLng,markerMuseo:c._markerMuseo});a.addLayer(f),b[e.nid]=f})},renderExposicion:function(a,b){this._exposicionesLayersHashMap[a].renderItinerancias(b)},getExposicionMarkers:function(a){return this._exposicionesLayersHashMap[a]._markers},clearAll:function(a){this._exposicionesLayers.eachLayer(function(a){a.clearItineranciasLayer()}),a||this.setView(this._mapCenter,this._initZoom,{animate:!0})},getExposicionLayers:function(){return this._exposicionesLayers}}),L.mapItinerancias=function(a,b,c){return new L.ItineranciasMap(a,b,c)},Slider={sliderTpl:ItineranciasTpls["app/templates/slider.hbs"],container:{},slides:{},map:{},fixed:!1,inj_target:$("footer"),initialize:function(a){this.inj_target.append(this.sliderTpl(exposiciones)),this.container=$("#slider-container"),this.container.mixItUp({animation:{duration:400,effects:"fade",easing:"ease"},controls:{enable:!1},callbacks:{onMixStart:function(b,c){if(a.clearAll(),$(".vacio p").hide(),".mix"==c.activeFilter)return void $(".itinerancia-marker").show();$(".itinerancia-marker").hide();var d="."+c.activeFilter.split(".").join("")+"-marker";$(d).show()},onMixFail:function(){$(".vacio p").show()}}}),this.slides=$(".slider-item"),this.map=a,this.bindActions()},bindActions:function(){var a=this;this.slides.hover(function(){a.fixed||(layer_id=$(this).data("layer"),a.map.renderExposicion(layer_id,!0))},function(){a.fixed||a.map.clearAll(!0)}).bind("click",function(b){b.preventDefault(),a.fixed&&$(this).is(".active")?a.clearFixed():a.fixed&&!$(this).is(".active")?(a.clearFixed(),a.fixed=!0,$(this).addClass("active"),layer_id=$(this).data("layer"),a.mostrarExposicion(layer_id),a.map.renderExposicion(layer_id,!1)):a.fixed||$(this).is(".active")||(a.fixed=!0,$(this).addClass("active"),layer_id=$(this).data("layer"),a.mostrarExposicion(layer_id),a.map.renderExposicion(layer_id,!1))})},clearFixed:function(){this.fixed=!1,this.container.find(".active").removeClass("active"),this.map.clearAll(!0)},mostrarExposicion:function(a){markers=this.map.getExposicionMarkers(a);var b=markers[0];$.event.trigger({type:"verItinerancia",exposicion_marker:b})},on:function(a,b){return this.eventList[a]=b,this},off:function(a){this.eventList[a]&&(this.eventList[a]=!1)}};var buttonFilter={$filters:null,$reset:null,groups:[],outputArray:[],outputString:"",init:function(){var a=this;a.$filters=$("#Filters"),a.$reset=$("#Reset"),a.$container=$("#slider-container"),a.$filters.find("fieldset").each(function(){a.groups.push({$buttons:$(this).find(".filter"),active:""})}),a.bindHandlers()},bindHandlers:function(){var a=this;a.$filters.on("click",".filter",function(b){b.preventDefault();var c=$(this);c.hasClass("active")?c.removeClass("active"):c.addClass("active").siblings(".filter").removeClass("active"),a.$reset.removeClass("active"),$(a).trigger("filter",[c,c.hasClass("active")]),a.parseFilters()}),a.$reset.on("click",function(b){a.$reset.addClass("active"),b.preventDefault(),$(a).trigger("reset"),a.$filters.find(".filter").removeClass("active"),a.parseFilters()})},parseFilters:function(){for(var a,b=this,c=0;a=b.groups[c];c++)a.active=a.$buttons.filter(".active").attr("data-filter")||"";b.concatenate()},concatenate:function(){var a=this;a.outputString="";for(var b,c=0;b=a.groups[c];c++)a.outputString+=b.active;!a.outputString.length&&(a.outputString="all"),a.$container.mixItUp("isLoaded")&&a.$container.mixItUp("filter",a.outputString)}};$(function(){buttonFilter.init()}),function(){function a(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}$(".open-popup-link").magnificPopup({removalDelay:500,mainClass:"mfp-zoom-in",showCloseBtn:!1,type:"inline",callbacks:{beforeOpen:function(){this.st.mainClass=this.st.el.attr("data-effect")}}}).magnificPopup("open"),$(".btn-popup").click(function(){$.magnificPopup.close()});var b=a("estilo"),c="http://api.tiles.mapbox.com/v4/mncars.jdnk71aa/{z}/{x}/{y}.png256?access_token=pk.eyJ1IjoibW5jYXJzIiwiYSI6Ikd4LVhVVzQifQ.4aiQLhuKLILjMBNLFkDGxA";1==b?c="http://api.tiles.mapbox.com/v4/mncars.jb6c075e/{z}/{x}/{y}.png256?access_token=pk.eyJ1IjoibW5jYXJzIiwiYSI6Ikd4LVhVVzQifQ.4aiQLhuKLILjMBNLFkDGxA":2==b?c="http://{s}.tiles.mapbox.com/v3/openplans.map-g4j0dszr/{z}/{x}/{y}.png":3==b&&(c="http://api.tiles.mapbox.com/v4/mncars.jdnkpc5f/{z}/{x}/{y}.png256?access_token=pk.eyJ1IjoibW5jYXJzIiwiYSI6Ikd4LVhVVzQifQ.4aiQLhuKLILjMBNLFkDGxA");var d={tileUrl:c,tileAttrib:"Map tiles &copy; MapBox and OpenStreetMap ",initLatLng:new L.LatLng(40.408192,-3.694337),mapCenter:new L.LatLng(10,-28),initZoom:$(window).width()<800?2:3,minZoom:2,maxZoom:15},e=new Snap({element:document.getElementById("content"),touchToDrag:!1,maxPosition:265,minPosition:-265});e.on("close",function(){$("footer").removeClass("hide-bottom"),f.closePopup()}),$(".snap-close").click(function(){e.close()}),$("#open-left").click(function(){"closed"==e.state().state?($("footer").addClass("hide-bottom"),e.settings.maxPosition=265,e.settings.minPosition=-265,e.open("left")):e.close()});var f=L.mapItinerancias("map",exposiciones,{minZoom:d.minZoom,maxZoom:d.maxZoom,zoomControl:!1,snapper:e,initZoom:d.initZoom,initLatLng:d.initLatLng,riseOnHover:!0,mapCenter:d.mapCenter});new L.Control.Zoom({position:"topright"}).addTo(f),f.addLayer(new L.TileLayer(d.tileUrl,{attribution:d.tileAttrib})),f.setView(d.mapCenter,d.initZoom),$("html").hasClass("lt-ie9")||Slider.initialize(f),$(document).on("verItinerancia",function(a){f.clearAll(!0),a.exposicion_marker.renderItinerancia(),$(".exposicionThumbnail").html(a.exposicion_marker.getPopup()),$("footer").addClass("hide-bottom"),e.settings.maxPosition=320,e.settings.minPosition=-320,e.open("right")}),$("select").change(function(){return f.clearAll(),f.closePopup(),"all"==this.value?void $(".itinerancia-marker").show():($(".itinerancia-marker").hide(),$(this.value+"-marker").show(),void e.close())}),$buttonFilter=$(buttonFilter),$buttonFilter.on("filter",function(a,b,c){b.hasClass("filter--exposicion")&&c?b.siblings(".filter--exposicion-tipo:not(.shown)").addClass("shown"):b.siblings(".filter--exposicion-tipo.shown").removeClass("shown")}).on("reset",function(){$(".filter.shown").removeClass("shown")})}();